<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>决策生成器</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-size: cover;
            background-position: center;
            transition: background-image 2s ease-in-out; /* Smooth transition for background image */
            display: flex;
            flex-direction: column; /* Use column to center content vertically */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Prevent scrollbars from background animation */
            color: white; /* Default text color for better contrast with backgrounds */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Add text shadow for readability */
        }

        /* Animation effect for answer text */
        .answer-text.fade-in {
            animation: fadeIn 1s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Dynamic effect for buttons */
        .button-pulse:hover {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        /* Background bubble animation */
        .bubble-container {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            overflow: hidden;
            z-index: -1;
        }

        .bubble {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: floatUp 15s infinite ease-in-out;
            opacity: 0;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            20% {
                opacity: 1;
            }
            100% {
                transform: translateY(-20vh) scale(1.2);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div class="bubble-container"></div>

    <!-- Answer display directly in body -->
    <div id="answerDisplay" class="answer-text text-3xl sm:text-4xl font-semibold text-white text-center mb-8 max-w-3xl px-4 transition-all duration-700 ease-in-out transform hover:scale-105">
        <!-- Initial text is empty, first answer loaded by JS -->
    </div>

    <!-- Share button fixed to bottom right -->
    <button id="shareBtn" class="button-pulse fixed bottom-8 right-8 bg-gradient-to-r from-blue-500 to-teal-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 ease-in-out transform hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-blue-300 flex items-center justify-center z-10">
        Share
    </button>

    <!-- Message box (kept for potential future use, but hidden by default) -->
    <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl text-center text-gray-800">
            <p id="messageText" class="text-lg font-semibold mb-4"></p>
            <button id="closeMessageBox" class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">确定</button>
        </div>
    </div>

    <script type="module">
        // Ensure __app_id and __firebase_config are available in the Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;

        // Decision answer list (English version)
        const englishAnswers = [];
        const baseFriendlyPhrases = [
            `Hey, why not just go for it? What's the worst that could happen?`,
            `Trust your gut on this one, seriously. It usually knows best.`,
            `Take a deep breath and think about what truly makes you happy.`,
            `Don't overthink it, sometimes the simplest choice is the best.`,
            `Talk it out with someone you trust, a fresh perspective always helps.`,
            `If it feels right, it probably is. Go with that feeling!`,
            `What if you tried something completely different? Could be a fun adventure!`,
            `It's totally okay to not know right away. Give yourself some time.`,
            `Just pick one and see what happens! Life's full of surprises.`,
            `Think about what you'd tell a friend in your shoes. That usually helps.`,
            `No pressure, but sometimes a little leap of faith is exactly what you need.`,
            `Consider what would bring you the most peace, not just the easiest path.`,
            `It's your call, but maybe list out the pros and cons on a piece of paper?`,
            `Don't let fear hold you back. What's the best case scenario here?`,
            `You've got this! Whatever you choose, it'll be the right one for you.`,
            `If it's causing too much stress, maybe it's time to simplify.`,
            `What's your heart telling you? Listen to that whisper.`,
            `Sometimes, doing nothing is also a decision. Is that what you need?`,
            `Just make a choice and commit to it. You can always adjust later.`,
            `Imagine yourself a year from now. Which choice would you be glad you made?`,
            `Take a step back and look at the bigger picture.`,
            `What's the riskiest option? Is it worth it?`,
            `Sleep on it. Things often look clearer in the morning.`,
            `Don't try to please everyone. This decision is for you.`,
            `What's the easiest path? Is it the right one?`,
            `Visualize success with each option. Which feels better?`,
            `Is there a middle ground? Sometimes compromise is key.`,
            `Ask yourself: 'Will I regret not doing this?'`,
            `Consider the impact on your energy and time.`,
            `What's your intuition saying? It's often right.`,
            `Break it down into smaller, manageable steps.`,
            `If money wasn't an issue, what would you choose?`,
            `What's the most responsible choice for your future self?`,
            `Don't rush. A well-thought-out decision is better than a quick one.`,
            `Is there a way to test out each option first?`,
            `What's the worst-case scenario, and can you live with it?`,
            `Think about your core values. Which choice aligns best?`,
            `Sometimes, the best decision is to wait for more clarity.`,
            `What's the most exciting option? Follow that spark!`,
            `Consider the long-term consequences, not just the immediate ones.`,
            `What's the most practical choice right now?`,
            `Don't let perfection be the enemy of good enough.`,
            `Is this decision reversible? That might make it easier.`,
            `What's the most authentic choice for you?`,
            `Think about what you've learned from past decisions.`,
            `Is there a creative solution you haven't considered yet?`,
            `What's the option that brings you the most peace of mind?`,
            `Don't be afraid to change your mind later if needed.`,
            `What's the most empowering choice for you?`,
            `Sometimes, the answer is simply 'no' to everything else.`,
            `If you had to choose right now, what would it be?`,
            `Consider the ripple effect of your decision.`,
            `What's the option that challenges you to grow?`,
            `Don't let external pressure dictate your choice.`,
            `What's the simplest way to move forward?`,
            `Is there an opportunity hidden in this decision?`,
            `What's the most courageous path you could take?`,
            `Think about what truly matters to you in the long run.`,
            `What's the most flexible option, allowing for changes?`,
            `Sometimes, the answer is just to trust the process.`,
            // New direct and whimsical phrases
            `Yes!`,
            `No.`,
            `Maybe.`,
            `Go for it!`,
            `Don't do it.`,
            `You got this!`,
            `Trust yourself.`,
            `Not now.`,
            `Definitely.`,
            `Absolutely not.`,
            `Perhaps.`,
            `It's a strong yes.`,
            `A clear no.`,
            `The stars align for you.`,
            `Perhaps luck is on your right side.`, // "或许你的运气在右边"
            `Listen to your heart.`,
            `Take a chance!`,
            `Think again.`,
            `The answer is within you.`,
            `Proceed with caution.`,
            `It's a good idea.`,
            `It's not the right time.`,
            `Follow your instincts.`,
            `The universe says yes.`,
            `The universe says no.`,
            `It's a sign!`,
            `Wait for a better moment.`,
            `You're on the right track.`,
            `Reconsider.`,
            `It's a definite maybe.`
        ];

        // Corresponding Chinese translations for baseFriendlyPhrases
        // These are pre-translated to ensure offline functionality and avoid API errors.
        const baseChinesePhrases = [
            `嘿，为什么不试试看呢？最坏的情况又能怎样？`,
            `这次听从你的直觉，真的。它通常最清楚。`,
            `深呼吸，想想什么能真正让你快乐。`,
            `别想太多，有时候最简单的选择就是最好的。`,
            `和信任的人聊聊，新的视角总是有帮助的。`,
            `如果感觉对了，那可能就是对的。跟着感觉走！`,
            `如果你尝试一些完全不同的东西呢？那可能是一次有趣的冒险！`,
            `不知道答案也没关系。给自己一些时间。`,
            `随便选一个，看看会发生什么！生活充满了惊喜。`,
            `想想如果你是朋友，你会怎么建议自己。这通常会有帮助。`,
            `没有压力，但有时候一点点信念的飞跃正是你所需要的。`,
            `考虑什么能给你带来最大的平静，而不仅仅是最简单的路。`,
            `由你决定，但也许可以把利弊列在纸上？`,
            `别让恐惧束缚你。最好的情况会是怎样？`,
            `你能行的！无论你选择什么，那对你来说都会是正确的。`,
            `如果它带来了太多压力，也许是时候简化一下了。`,
            `你的心在告诉你什么？倾听那个低语。`,
            `有时候，什么都不做也是一种决定。那是你需要的吗？`,
            `就做个选择并坚持下去。你总能以后再做调整。`,
            `想象一年后的自己。你会庆幸做了哪个选择？`,
            `退一步，看看大局。`,
            `哪个选项风险最大？值得吗？`,
            `睡一觉。早上事情通常会更清楚。`,
            `不要试图取悦所有人。这个决定是为你自己做的。`,
            `哪条路最容易？它是正确的吗？`,
            `想象每个选项的成功。哪个感觉更好？`,
            `有折中方案吗？有时候妥协是关键。`,
            `问问自己：‘我会后悔没有这样做吗？’`,
            `考虑它对你的精力和时间的影响。`,
            `你的直觉在说什么？它通常是对的。`,
            `把它分解成更小、更容易管理的步骤。`,
            `如果钱不是问题，你会选择什么？`,
            `对未来的你来说，哪个选择最负责任？`,
            `不要急。深思熟虑的决定胜过仓促的决定。`,
            `有没有办法先测试一下每个选项？`,
            `最坏的情况是什么，你能接受吗？`,
            `想想你的核心价值观。哪个选择最符合？`,
            `有时候，最好的决定是等待更清晰的时机。`,
            `哪个选项最令人兴奋？追随那个火花！`,
            `考虑长期的后果，而不仅仅是眼前的。`,
            `现在最实际的选择是什么？`,
            `不要让完美成为优秀的敌人。`,
            `这个决定可逆吗？那可能会让它更容易。`,
            `对你来说，哪个选择最真实？`,
            `想想你从过去的决定中学到了什么。`,
            `有没有你还没考虑过的创意解决方案？`,
            `哪个选项能给你带来最大的安心？`,
            `如果需要，不要害怕以后改变主意。`,
            `哪个选项最能赋予你力量？`,
            `有时候，答案就是对其他一切说“不”。`,
            `如果你现在必须选择，会是什么？`,
            `考虑你决定的连锁反应。`,
            `哪个选项能挑战你成长？`,
            `不要让外部压力左右你的选择。`,
            `前进最简单的方法是什么？`,
            `这个决定中是否隐藏着机会？`,
            `你能选择的最勇敢的道路是什么？`,
            `从长远来看，想想什么对你真正重要。`,
            `哪个选项最灵活，允许改变？`,
            `有时候，答案就是相信过程。`,
            // New direct and whimsical phrases (Chinese translations)
            `可以！`,
            `不行。`,
            `也许吧。`,
            `放手去做！`,
            `别做。`,
            `你能行的！`,
            `相信自己。`,
            `现在不行。`,
            `当然。`,
            `绝对不行。`,
            `或许。`,
            `这是个强烈的肯定。`,
            `一个明确的否定。`,
            `众星为你闪耀。`,
            `或许你的运气在右边。`,
            `倾听你的心声。`,
            `冒个险！`,
            `再想想。`,
            `答案在你心中。`,
            `谨慎行事。`,
            `这是个好主意。`,
            `时机不对。`,
            `跟随你的直觉。`,
            `宇宙说可以。`,
            `宇宙说不行。`,
            `这是个信号！`,
            `等待更好的时机。`,
            `你走在正确的轨道上。`,
            `重新考虑。`,
            `这很可能是个肯定。`
        ];


        // Populate 1000 answers by cycling through the expanded base phrases
        for (let i = 0; i < 1000; i++) {
            englishAnswers.push(baseFriendlyPhrases[i % baseFriendlyPhrases.length]);
        }

        // Populate 1000 Chinese answers mirroring the English ones
        const chineseAnswers = [];
        for (let i = 0; i < 1000; i++) {
            chineseAnswers.push(baseChinesePhrases[i % baseChinesePhrases.length]);
        }


        // Array of publicly accessible natural landscape image URLs from Picsum Photos
        // Using new IDs focused on pure landscapes, without people or animals.
        const backgroundImages = []; // This will be populated after successful preloading
        const imageSources = [
            `https://picsum.photos/id/10/1920/1080?blur=2`, // Forest path
            `https://picsum.photos/id/11/1920/1080?blur=2`, // Mountain range
            `https://picsum.photos/id/12/1920/1080?blur=2`, // Lake with trees
            `https://picsum.photos/id/14/1920/1080?blur=2`, // Forest road
            `https://picsum.photos/id/15/1920/1080?blur=2`, // River in nature
            `https://picsum.photos/id/16/1920/1080?blur=2`, // Ocean waves
            `https://picsum.photos/id/18/1920/1080?blur=2`, // Mountain landscape
            `https://picsum.photos/id/19/1920/1080?blur=2`, // Forest stream
            `https://picsum.photos/id/20/1920/1080?blur=2`, // Lake sunset
            `https://picsum.photos/id/21/1920/1080?blur=2`, // Mountain landscape (different one)
            `https://picsum.photos/id/22/1920/1080?blur=2`, // Forest light
            `https://picsum.photos/id/23/1920/1080?blur=2`, // River rocks
            `https://picsum.photos/id/24/1920/1080?blur=2`, // Forest trees
            `https://picsum.photos/id/26/1920/1080?blur=2`, // Mountain view
            `https://picsum.photos/id/27/1920/1080?blur=2`, // Forest floor
            `https://picsum.photos/id/28/1920/1080?blur=2`, // Desert at sunset
            `https://picsum.photos/id/29/1920/1080?blur=2`, // Mountain peak with clouds
            `https://picsum.photos/id/30/1920/1080?blur=2`, // Forest path with sunlight
            `https://picsum.photos/id/31/1920/1080?blur=2`, // Ocean horizon
            `https://picsum.photos/id/32/1920/1080?blur=2`, // Mountain lake
            `https://picsum.photos/id/33/1920/1080?blur=2`, // Forest waterfall
            `https://picsum.photos/id/34/1920/1080?blur=2`, // Desert landscape
            `https://picsum.photos/id/35/1920/1080?blur=2`, // Forest with snow
            `https://picsum.photos/id/36/1920/1080?blur=2`, // Ocean waves on rocks
            `https://picsum.photos/id/37/1920/1080?blur=2`, // Lake reflections
            `https://picsum.photos/id/38/1920/1080?blur=2`, // Mountain road
            `https://picsum.photos/id/39/1920/1080?blur=2`, // Forest with fog
            `https://picsum.photos/id/40/1920/1080?blur=2`, // Desert vastness
            `https://picsum.photos/id/41/1920/1080?blur=2`, // Lake shore
            `https://picsum.photos/id/42/1920/1080?blur=2`, // Mountain range at dawn
            `https://picsum.photos/id/43/1920/1080?blur=2`, // Forest canopy
            `https://picsum.photos/id/44/1920/1080?blur=2`, // Ocean sunset horizon
            `https://picsum.photos/id/45/1920/1080?blur=2`, // Desert rock formations
            `https://picsum.photos/id/46/1920/1080?blur=2`, // Mountain stream
            `https://picsum.photos/id/47/1920/1080?blur=2`, // Forest path in autumn
            `https://picsum.photos/id/48/1920/1080?blur=2`, // Lake with boat (still keeping this, as it's a small boat, not a person)
            `https://picsum.photos/id/49/1920/1080?blur=2`, // Mountain peaks from above
            `https://picsum.photos/id/50/1920/1080?blur=2`, // Forest trees in winter
            `https://picsum.photos/id/51/1920/1080?blur=2`, // Ocean waves crashing
            `https://picsum.photos/id/52/1920/1080?blur=2`, // Mountain valley
            `https://picsum.photos/id/53/1920/1080?blur=2`, // Forest with sunlight
            `https://picsum.photos/id/54/1920/1080?blur=2`, // Lake with clear water
            `https://picsum.photos/id/55/1920/1080?blur=2`, // Desert with sparse vegetation
            `https://picsum.photos/id/56/1920/1080?blur=2`, // Mountain peaks from below
            `https://picsum.photos/id/57/1920/1080?blur=2`, // River bend
            `https://picsum.photos/id/58/1920/1080?blur=2`, // Ocean beach
            `https://picsum.photos/id/59/1920/1080?blur=2`, // Forest clearing
            `https://picsum.photos/id/60/1920/1080?blur=2`, // Lake with mist
            `https://picsum.photos/id/61/1920/1080?blur=2`, // Mountain panorama
            `https://picsum.photos/id/62/1920/1080?blur=2`  // Desert sunset
        ];
        let currentBackgroundIndex = 0;
        let backgroundChangeIntervalId; // To store the interval ID for clearing

        // UI elements
        const answerDisplay = document.getElementById('answerDisplay');
        const shareBtn = document.getElementById('shareBtn'); // Share button
        // messageBox is now hidden by default and its functionality integrated into answerDisplay
        const messageBox = document.getElementById('messageBox'); // Keep reference, but it's hidden
        const messageText = document.getElementById('messageText'); // Keep reference, but it's hidden
        const closeMessageBox = document.getElementById('closeMessageBox'); // Keep reference, but it's hidden

        // Function to show message box (no longer actively used for translation errors)
        function showMessageBox(message) {
            messageText.textContent = message;
            messageBox.classList.remove('hidden');
        }

        // Function to hide message box (no longer actively used for translation errors)
        closeMessageBox.addEventListener('click', () => {
            messageBox.classList.add('hidden');
        });

        // Function to change background image
        function changeBackground() {
            if (backgroundImages.length > 0) {
                document.body.style.backgroundImage = `url('${backgroundImages[currentBackgroundIndex]}')`;
                currentBackgroundIndex = (currentBackgroundIndex + 1) % backgroundImages.length;
            } else {
                // Fallback if no images loaded (e.g., network issues)
                document.body.style.backgroundImage = 'none';
                document.body.style.backgroundColor = '#667eea'; // A default fallback color
                console.warn("所有背景图片加载失败。将使用纯色背景。");
            }
        }

        // Function to select and display a random answer
        async function displayRandomAnswer() {
            // Remove old animation class to reapply
            answerDisplay.classList.remove('fade-in');
            // Force reflow to ensure animation resets
            void answerDisplay.offsetWidth;

            const randomIndex = Math.floor(Math.random() * englishAnswers.length);
            const selectedEnglishAnswer = englishAnswers[randomIndex]; // Store the original English answer
            const selectedChineseAnswer = chineseAnswers[randomIndex]; // Get the corresponding Chinese answer

            // Detect browser language
            const userLang = navigator.language || navigator.userLanguage;
            const isChinese = userLang.startsWith('zh');

            let displayHtml = `<span class="block">${selectedEnglishAnswer}</span>`; // Default to English answer, wrapped in a block span

            // If in Chinese environment, display both languages
            if (isChinese) {
                // Display English on top, Chinese on bottom
                displayHtml = `<span class="block">${selectedEnglishAnswer}</span><span class="block text-xl opacity-75 mt-2">${selectedChineseAnswer}</span>`;
            }

            answerDisplay.innerHTML = displayHtml; // Use innerHTML for <br> tag and spans
            answerDisplay.classList.add('fade-in'); // Add animation class
        }

        // Function to preload and load background images
        async function loadBackgroundImages() {
            answerDisplay.textContent = "正在加载背景图片..."; // Update loading message
            answerDisplay.classList.add('fade-in');

            const imagePromises = imageSources.map((src, index) => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.src = src;
                    img.onload = () => {
                        console.log(`Image ${index + 1} loaded successfully: ${src}`);
                        resolve(src);
                    };
                    img.onerror = () => {
                        console.error(`Failed to load image ${index + 1}: ${src}`);
                        resolve(null); // Resolve with null if image fails, so Promise.all doesn't reject
                    };
                });
            });

            const loadedImages = await Promise.all(imagePromises);
            backgroundImages.push(...loadedImages.filter(url => url !== null)); // Add only successfully loaded URLs

            console.log(`成功加载了 ${backgroundImages.length} 张背景图片。`);

            // Clear loading message before displaying answer
            answerDisplay.textContent = "";

            // Set initial background and start interval only if images were loaded
            if (backgroundImages.length > 0) {
                displayRandomAnswer(); // Display initial answer
                if (backgroundChangeIntervalId) {
                    clearInterval(backgroundChangeIntervalId);
                }
                changeBackground(); // Set initial background image
                backgroundChangeIntervalId = setInterval(changeBackground, 10000); // Change background every 10 seconds
            } else {
                console.warn("所有背景图片加载失败。将使用纯色背景。");
                document.body.style.backgroundImage = 'none'; // Clear any potential broken image
                document.body.style.backgroundColor = '#667eea'; // Fallback to a default color
                displayRandomAnswer(); // Still display an answer even if no background
            }
        }


        // On page load, display a random answer and set up background/answer auto-updates
        window.onload = () => {
            createBubbles(); // Create background bubbles
            loadBackgroundImages(); // Load and start cycling through background images
        };

        // Share button click event
        shareBtn.addEventListener('click', () => {
            window.open('https://moonynails.com/', '_blank'); // Open link in new tab
        });

        // Create background bubble effect
        function createBubbles() {
            const bubbleContainer = document.querySelector('.bubble-container');
            const numberOfBubbles = 20; // Number of bubbles

            for (let i = 0; i < numberOfBubbles; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('bubble');
                const size = Math.random() * 60 + 20; // Bubble size 20px - 80px
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${Math.random() * 100}%`; // Random horizontal position
                bubble.style.animationDuration = `${Math.random() * 10 + 10}s`; // Animation duration 10s - 20s
                bubble.style.animationDelay = `${Math.random() * 5}s`; // Animation delay 0s - 5s
                bubbleContainer.appendChild(bubble);
            }
        }
    </script>
</body>
</html>
